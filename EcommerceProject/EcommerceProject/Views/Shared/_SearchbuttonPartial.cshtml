<!DOCTYPE html>
<html>
<head>
    <link href="~/css/Searchbar.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js" type="text/javascript"></script>
    <style>
        #result {
            position: absolute;
            width: 100%;
            max-width: 870px;
            cursor: pointer;
            overflow-y: auto;
            max-height: 400px;
            box-sizing: border-box;
            z-index: 1001;
        }

        .link-class:hover {
            background - color: #f1f1f1;
        }
    </style>
</head>
<body>
    <div class="topnav">
        <a href="#news">Search for a product</a>
        <input type="text" id="mySearch" onkeyup="" placeholder="Search for a product..." title="Type in a category">
        <ul class="list-group" id="result"></ul>
        <button type="submit" id="buttonm"></button>
    </div>

    <script>
        $(document).ready(function () {
            $("#mySearch").keyup(function () {
                $("#result").html("");
                var searchField = $("#mySearch").val();
                var regex = new RegExp(searchField, "i");
                $.getJSON("/search/products.json", function (data) {
                    $.each(data, function (key, value) {
                        if (value.name.search(regex) != -1) {
                            $("#result").append('<li class="list-group-item">' + value.name + '</li>')
                        }
                    })
                })
            })
        })

        $('#result').on('click', 'li', function () {
            var click_text = $(this).text().split('|');
            $('#search').val($.trim(click_text[0]));
            $("#result").html('');
        });


        /*
        $document.ready(function () {
            $("#mySearch").autocomplete({
                source: function (request, response) {
                    $.ajax({
                        url: "~/wwwroot/search/products.json",
                        method: 'post',
                        contentType: 'application/json; charset=utf-8',
                        data: { term: request.term }
                        success: function (data) {
                            response(data.d);
                        },
                        error: function (err) {
                            alert(err);
                        }
                    })
                }
            })
        })
        */

        /*
        $(document).ready(function () {
            $("#mySearch").autocomplete({
                delay: 0,
                source: function (request, response) {
                    $ajax({
                        url: "~/wwwroot/search/products.json",
                        dataType: "json",
                        data: { term: request.term },
                        success: function (data) {
                            response($map(data, function (item) {
                                return {
                                    value: item.value
                                };
                            }))
                        }
                    });
                },
            });
            minLength: 1
        })


                minLength: 1,
                source: function (request, response) {
                    $.getJSON("~/wwwroot/search/products.json",
                        function (data) {
                            response($.map(data, function (item) {
                                return item.value;
                            }));
        });*/
    </script>


    <script>
        var button = document.getElementById("buttonm");

        button.onclick = function () {
            var text = document.getElementById("mySearch").value;
            window.location.href = '@Url.Action("SearchProduct", "Products", new {id= "value"})'.replace("value", text);
        }


    </script>
</body>
</html>